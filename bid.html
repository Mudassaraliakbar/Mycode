<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Deal Details</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="shortcut icon"
      href="assets/images/logomini.png"
      type="image/x-icon"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/deal.css" />
    <link rel="stylesheet" href="css/swiperbullets.css" />
  </head>
  <body>
    <!-- navbar start -->
    <nav
      class="navbar navbar-expand-xl custom-container rounded-4 p-0"
      id="main-navbar"
    >
      <div class="container-fluid p-0">
        <a class="navbar-brand fw-semibold logo" href="index.html">
          <img
            src="assets/images/logo.png"
            alt=""
            width="161"
            height="48"
            class="d-inline-block align-text-center"
          /></a
        >
        <button
          class="navbar-toggler p-0"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbar-menu"
          aria-controls="navbar-menu"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <img src="assets/svgs/menu.svg" alt="" id="navbar-icon" />
        </button>

        <div
          class="collapse navbar-collapse justify-content-center flex-grow-1"
          id="navbar-menu"
        >
          <ul class="navbar-nav mb-2 mb-xl-0">
            <nav
              class="navbar navbar-expand-xl rounded-4 mobile-nav d-xl-none "
              id="main-navbar"
            >
              <div class="container-fluid m-0 p-0">
                <a class="navbar-brand fw-semibold logo" href="index.html">
                  <img
                    src="assets/images/logo.png"
                    alt=""
                    width="161"
                    height="48"
                    class="d-inline-block align-text-center"
                  />
                </a
                >
                <button
                  class="navbar-toggler p-0"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#navbar-menu"
                  aria-controls="navbar-menu"
                  aria-expanded="false"
                  aria-label="Toggle navigation"
                >
                  <img src="assets/svgs/close.svg" alt="" id="navbar-icon" />
                </button>
              </div>
            </nav>

            <li class="nav-item">
              <a
                class="nav-link  fw-normal d-flex justify-content-between"
                href="index.html"
                >Home
                <img
                  src="assets/svgs/chevron-right.svg"
                  alt=""
                  class="d-xl-none"
              /></a>
            </li>
            <!-- <li class="nav-item">
              <a
                class="nav-link fw-normal d-flex justify-content-between"
                href="#"
                >Deals
                <img
                  src="assets/svgs/chevron-right.svg"
                  alt=""
                  class="d-xl-none"
              /></a>
            </li> -->
            <li class="nav-item">
              <a
                class="nav-link fw-normal d-flex justify-content-between"
                href="pastDeal.html"
                >Past Deals
                <img
                  src="assets/svgs/chevron-right.svg"
                  alt=""
                  class="d-xl-none"
              /></a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link fw-normal d-flex justify-content-between"
                href="#"
                >Bald verfugbar
                <img
                  src="assets/svgs/chevron-right.svg"
                  alt=""
                  class="d-xl-none"
              /></a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link fw-normal d-flex justify-content-between"
                href="#"
                >Community
                <img
                  src="assets/svgs/chevron-right.svg"
                  alt=""
                  class="d-xl-none"
              /></a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link fw-normal d-flex justify-content-between"
                href="#"
                >Help
                <img
                  src="assets/svgs/chevron-right.svg"
                  alt=""
                  class="d-xl-none"
              /></a>
            </li>
            <div class="d-block d-xl-none login-btn-mobile mt-4">
              <button class="btn">
                Login <img src="assets/svgs/user-rectangle.svg" alt="" />
              </button>
            </div>
          </ul>
        </div>

        <div class="d-none d-xl-block login-btn">
          <button class="btn">
            Login <img src="assets/svgs/user-rectangle.svg" alt="" />
          </button>
        </div>
      </div>
    </nav>
    <!-- navbar start -->

    <main>
      <section
        class="custom-container position-relative"
        id="bidding-section"
      ></section>
    </main>

     <!-- foooter start -->
     <footer class="custom-container">
        <div class="row footer-links">
          <div class="col-12 col-lg-4 footer-about mb-4 mb-lg-0">
            <div class="fw-semibold logo d-flex gap-2 align-items-center mb-4">
              <img
                src="assets/images/logo.png"
                alt=""
                width="161"
                height="48"
                class="d-inline-block align-text-center"
              />
            </div>
            <p class="mb-3">
              Our platform offer buying products through bidding which offer users
              to buy products with there capabilities.
            </p>
            <button class="btn d-flex align-items-center">
              <img src="assets/images/badge.png" alt="" width="26" height="30" />
              <span class="fw-medium text-start"
                >Schweizer Plattform für <br />
                Schweizer Deals</span
              >
            </button>
          </div>
          <div class="col-6 col-lg-2 mb-4 mb-lg-0 legal-links">
            <h5 class="mb-lg-2">Legal Links</h5>
            <a href="#" class="nav-link mb-lg-3">About</a>
            <a href="#" class="nav-link mb-lg-3">Legal Notice</a>
            <a href="#" class="nav-link mb-lg-3">Privacy Policy</a>
            <a href="#" class="nav-link mb-lg-3">Contact</a>
          </div>
          <div class="col-6 col-lg-2 mb-4 mb-lg-0 quick-links">
            <h5 class="mb-lg-2">Quick Links</h5>
            <a href="#" class="nav-link mb-lg-3">FAQ</a>
            <a href="#" class="nav-link mb-lg-3">Deals</a>
            <a href="#" class="nav-link mb-lg-3">Community</a>
          </div>
          <div class="col-12 col-lg-4 mt-4 mt-lg-0">
            <h4 class="fs-lg-4 fw-medium mb-lg-3 mb-1">
              Subscribe to our Newsletter
            </h4>
            <form class="mb-lg-3 mb-2 border-bottom pb-3" style="border-color: rgba(255, 255, 255, 0.4) !important;">
              <div class="input-group">
                <img src="assets/svgs/envalop.svg" alt="" />
                <input
                  type="email"
                  class="form-control bg-transparent border-0 text-white"
                  placeholder="Type your e-mail"
                />
                <button class="btn px-1" type="submit">
                  <img src="assets/svgs/right-arrow.svg" alt="" />
                </button>
              </div>
            </form>
            <p class="small mt-lg-1" style="color:rgba(255, 255, 255, 0.8) !important">
              Subscribe to our newsletter get weekly offers directly into your
              email
            </p>
          </div>
        </div>
        <div
          class="copy-right d-flex justify-content-lg-between gap-0 flex-column flex-lg-row align-items-center"
        >
          <p>Copyright by Dealfox © 2025</p>
          <div class="d-flex gap-3">
            <a href="#" class="nav-link">
              <img src="assets/svgs/instagram.svg" alt="" />
            </a>
            <a href="#" class="nav-link">
              <img src="assets/svgs/twitter.svg" alt="" />
            </a>
            <a href="#" class="nav-link">
              <img src="assets/svgs/facebook.svg" alt="" />
            </a>
          </div>
        </div>
      </footer>
      <!-- foooter end -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/data.js"></script>
    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const id = urlParams.get("id");
      const selectedDeal = deal.find((item) => item.id == id);
      const startPrice = parseFloat(selectedDeal.deal_price);
      const endPrice = parseFloat(selectedDeal.deal_min_price);
      const numberOfDeals = selectedDeal.number_of_deals || 36; // Default to 36 if not specified
      const priceIncrement = (endPrice - startPrice) / (numberOfDeals - 1);
      let selectedBids = [];
      let minSelectedBid = null;
      let maxSelectedBid = null;
      // Generate bid cards HTML

      // Generate bid cards HTML
      let bidCardsHTML = "";
      for (let i = 0; i < numberOfDeals; i++) {
        const currentPrice = startPrice + priceIncrement * i;
        const formattedPrice = parseInt(currentPrice);

        // let cardClass = "bid-card bid-card-unselected";
        // if (i === 0) cardClass += " bid-card-win";
        // else if (i === numberOfDeals - 1) cardClass += " bid-card-last";

        bidCardsHTML += `
    <div data-price="${formattedPrice}"   class="bid-card bid-card-unselected d-flex justify-content-center align-items-center flex-column"  onclick="selectBid(this)">
      <p class="m-0 p-0 text-center">CHF</p>
      <span class="fw-medium text-center">${formattedPrice}</span>
    </div>
  `;
      }

      // Select/Deselect bid function
   
function selectBid(element) {
  const price = parseInt(element.getAttribute("data-price"));
  const isSelected = element.classList.contains("bid-card-selected");

  if (!isSelected) {
    if (selectedBids.length >= 10) {
      alert("You can select maximum 10 bids");
      return;
    }
    selectedBids.push(price);
    element.classList.remove("bid-card-unselected");
    element.classList.add("bid-card-selected");
  } else {
    selectedBids = selectedBids.filter(bid => bid !== price);
    element.classList.remove("bid-card-selected");
    element.classList.add("bid-card-unselected");
  }

  // Update min/max
  if (selectedBids.length > 0) {
    minSelectedBid = Math.min(...selectedBids);
    maxSelectedBid = Math.max(...selectedBids);
  } else {
    minSelectedBid = null;
    maxSelectedBid = null;
  }

  // Update card classes for min/max
  updateCardClasses();

  updateBidSelectionUI();
}

function updateCardClasses() {
  // Remove win/last classes from all cards first
  document.querySelectorAll('.bid-card').forEach(card => {
    card.classList.remove('bid-card-win', 'bid-card-last');
  });

  // Add special classes if we have selected bids
  if (selectedBids.length > 0) {
    // Find and mark the lowest selected bid
    document.querySelector(`.bid-card[data-price="${minSelectedBid}"]`).classList.add('bid-card-win');
    
    // Find and mark the highest selected bid
    document.querySelector(`.bid-card[data-price="${maxSelectedBid}"]`).classList.add('bid-card-last');
  } else {
    // Restore default first/last classes if no bids selected
    document.querySelector('.bid-card-first').classList.add('bid-card-first');
    document.querySelector('.bid-card-last').classList.add('bid-card-last');
  }
}


      function updateBidSelectionUI() {
        // Update counter
        const bidCounter = document.querySelector(".bid-winning h4");
        if (bidCounter) {
          bidCounter.textContent = `Selected bids: ${selectedBids.length}/10`;
        }

        // Update range text
        const rangeText = document.querySelector(".bid-winning h5");
        if (rangeText) {
          rangeText.textContent =
            selectedBids.length > 0
              ? `All ${selectedBids.length} bids placed between CHF${minSelectedBid} to CHF${maxSelectedBid}`
              : "No bids selected";
        }

        // Update winning bid
        const winningBid = document.querySelector(
          ".bid-winning-card span.fs-2"
        );
        if (winningBid) {
          winningBid.textContent =
            minSelectedBid !== null ? `CHF${minSelectedBid}` : "CHF0";
        }

        // Update instruction text
        const instructionText = document.querySelector(".bid-winning span i");
        if (instructionText) {
          instructionText.textContent =
            selectedBids.length >= 10 ? "Maximum number reached" : " ";
        }

        const biddingPlace = document.querySelector(".bidding-place");
        if (biddingPlace) {
          biddingPlace.textContent =
            selectedBids.length >= 10
              ? " ✅ All 10 bids placed ⏰ Wait until the auction ends to see if you won the item"
              : "  ";
        }
      }

      // Initialize the bidding section
      const biddingSection = document.getElementById("bidding-section");
      if (biddingSection) {
        biddingSection.innerHTML = `... your existing HTML template ...`;

        // Add bid cards after the section is created
        const bidCardsContainer = document.querySelector(".bid-cards");
        if (bidCardsContainer) {
          bidCardsContainer.innerHTML = bidCardsHTML;
        }
      }

      // Insert into the DOM

      //   const biddingSection = document.getElementById("bidding-section");
      biddingSection.innerHTML = `<div class="d-flex flex-lg-row flex-column gap-3">
          <div class="bidding-product-details">
            <div class="bidding-product">
              <div class="d-flex align-items-center gap-1">
                <span style="color:rgba(255,255,255,0.8) !important">Home</span>
                <img src="assets/svgs/chevron-right.svg" alt="" />
                <span>deal detail page</span>
              </div>
              <h1 class="fw-bold fs-1 my-3">${selectedDeal.product_name}</h1>
            </div>

            <div class="d-flex gap-5 bidding-pricing mb-3">
              <div>
                <p>Orignal price</p>
                <h4 class="fw-bold">${selectedDeal?.deal_price}</h4>
              </div>
              <div>
                <p>dealfox price from</p>
                <h4 class="fw-bold">${selectedDeal?.deal_min_price}</h4>
              </div>
            </div>

            <div class="bidding-overview">
              <h4 class="fw-medium">Overview</h4>
              <p
                style="
                  display: -webkit-box;
                  -webkit-line-clamp: 2;
                  -webkit-box-orient: vertical;
                  overflow: hidden;
                  text-overflow: ellipsis;
                  color:rgba(255,255,255,0.8) !important;
                "
              >
            ${selectedDeal?.overview}
              </p>
            </div>
<p class="bidding-place">
      
      </p>

          </div>

          <div class="bidding-details">
        
            <div class="bidding-points d-flex gap-2 w-100 flex-wrap ">
              <div
                class="d-flex justify-content-center flex-column align-items-center rounded-3 px-2"
              >
                <span class="fs-6 fw-medium bg-white text-black rounded-5 mb-1">
                  01
                </span>
                <p class="text-center mt-2">
                  Choose up to 10 <br />
                  CHF amounts
                </p>
              </div>
              <div
                class="d-flex justify-content-center flex-column align-items-center rounded-3 px-2"
              >
                <span class="fs-6 fw-medium bg-white text-black rounded-5 mb-1">
                  02
                </span>
                <p class="text-center mt-2">See your <br />only bids</p>
              </div>
              <div
                class="d-flex justify-content-center flex-column align-items-center rounded-3 px-2"
              >
                <span class="fs-6 fw-medium bg-white text-black rounded-5 mb-1">
                  03
                </span>
                <p class="text-center mt-2">
                  Loverd one time <br />
                  bid wins  
                </p>
              </div>
              <div
                class="d-flex justify-content-center flex-column align-items-center rounded-3 px-2"
              >
                <span class="fs-6 fw-medium bg-white text-black rounded-5 mb-1">
                  04
                </span>
                <p class="text-center mt-2">
                  Winning bid will be <br />
                  paid by
                </p>
              </div>
            </div>
            <div class="d-flex flex-column flex-lg-row mb-4 justify-content-between">
              <div class="bid-winning">
                <div class="mb-2 d-flex align-items-start gap-4">
                  <h4 class="fw-medium">Selected bids: 0/10</h4>
                  <button
                    class="btn text-black bg-white rounded-pill d-flex gap-2"
                  >
                    Learn more <img src="assets/svgs/info-mini.svg" alt="" />
                  </button>
                </div>
                <span style="color:rgba(255,255,255,0.8) !important;">Select up to 10 bids. Click on an amount to bid.
                  <i style="margin-left: 16px"></i></span
                >
                <h5 class="mb-3 fw-normal mt-3">
                  All 10 bids placed between CHF610 to CHF7705
                </h5>
              </div>
              <div class="bid-winning-card text-center py-3 px-4">
                <span class="d-block fw-semibold text-nowrap">Winning bid</span>
                <span class="fw-semibold fs-2">CHF0</span>
              </div>
            </div>
          </div>
        </div>
        <div class="bid-cards d-flex flex-wrap mb-4 justify-content-center" id="bid-cards">
        
        </div>
        <div class="bid-image">
          <div
            class="image-overlay w-100 position-absolute d-flex flex-column justify-content-between"
          >
            <img
              src="assets/images/premium-deal-badge.png"
              alt=""
              class="premium-badge"
            />
          </div>
          <img
            src=${selectedDeal.image}
            alt=${selectedDeal?.product_name}
            class="product-image w-100"
          />
        </div>
        <div class="d-flex justify-content-center">
          <button class="view-more-offer-btn btn p-0 my-5 fw-medium">
            View more offers
          </button>
        </div>`;

      document.querySelector(".bid-cards").innerHTML = bidCardsHTML;
    </script>
  </body>
</html>
